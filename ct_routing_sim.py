import math


distribution = [444 ,507 ,600 ,458 ,435, 600, 0] # (wsp, sl, ef, csr2, fi, fp, 0,0) MUST USE TAU not rho: last 2 spaces reserved for testing for potential new ct drops
#distribution = [480, 600, 600, 550, 522, 431,0]
ct_pub_count_array = [0,0,0,0,0,0,0,0]
ct_tau_array = [sum(distribution[0:7])]
ct_time_array = [0]


# custom theory routing data from xlii sim since linear approximation will go horribly wrong

wsp_pub_marks=[3.201397124,1.80140371,0.8122446968,0.8115750059,0.8142475957,0.8135809886,0.8142475957,3.120573931,0.9484129658,1.198657087,3.133538908,1.748962861,2.025305865,2.882524538,2.037426498,1.612783857,2.049218023,2.40654018,2.439332694,2.480006943,2.409933123,2.462397998,2.437750563,2.450249108,2.450249108,2.432969291,2.447158031,2.445604203,2.442479769,2.835690571,2.045322979,2.442479769,2.421603927,2.462397998,2.840733235,2.045322979,2.440909082,2.442479769,2.432969291,2.840106094,2.394451681,2.489958479,2.049218023,2.431363764,2.840106094,2.396199347,2.489958479,2.053078443,2.42975228,2.829946696,2.068185862,2.442479769,2.419955748,2.445604203,2.460897843,2.436162647,2.445604203,2.421603927,2.442479769,2.462397998,2.42975228,2.45484486,2.414973348,2.442479769,2.46686762,2.428134794,2.45331834,2.414973348,2.442479769,2.469822016,2.428134794,2.44870632,2.416640507,2.442479769,2.474216264,2.424881637,2.44870632,2.416640507,2.444044796,2.477121255,2.421603927,2.450249108,2.416640507,2.444044796,2.477121255,2.421603927,2.44870632,2.416640507,2.444044796,2.478566496,2.419955748,2.44870632,2.416640507,2.444044796,2.480006943,2.419955748,2.44870632,2.416640507,2.444044796,2.481442629,2.418301291,2.450249108,2.416640507,2.442479769,2.482873584,2.418301291,2.44870632,2.416640507,2.444044796,2.482873584,2.418301291,2.44870632,2.416640507,2.444044796,2.482873584,2.418301291,2.44870632,2.416640507,2.442479769,2.482873584,2.416640507,2.44870632,2.416640507,2.442479769,2.482873584,2.416640507,2.44870632,2.416640507,2.444044796,2.482873584,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.482873584,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,2.416640507,2.44870632,2.416640507,2.442479769,2.484299839,1.225317014]
wsp_rates=[31.7906,9.7815,7.33373,3.82083,1.73973,0.917954,0.467914,0.417078,1.24539,0.80735,0.621564,4.44377,3.14255,4.27588,8.14345,6.20975,6.02706,5.46588,5.30922,4.52659,4.17497,4.04342,3.92679,4.20403,4.01193,4.09372,3.98591,3.89673,4.95815,5.03006,5.36592,5.56158,5.3205,5.74492,5.89784,6.35746,6.72183,7.27755,9.07042,9.1353,9.90148,10.5168,10.2589,10.9782,10.5615,11.2784,11.8351,11.4227,12.1523,11.4267,11.8135,12.2372,11.8412,12.3054,11.4543,11.7283,11.7632,11.1968,11.5782,10.6885,10.8089,10.6697,10.0466,10.2884,9.44093,9.49303,9.25181,8.62094,8.76395,7.96543,7.9907,7.76152,7.16348,7.24274,6.55608,6.56113,6.35662,5.83299,5.87928,5.29953,5.28676,5.10569,4.67615,4.69608,4.22862,4.20903,4.0647,3.71528,3.72032,3.34216,3.3187,3.20254,2.92659,2.93079,2.62897,2.60874,2.5147,2.29685,2.29832,2.05986,2.04357,1.96856,1.79671,1.79878,1.61065,1.59657,1.53753,1.40311,1.40379,1.25711,1.24693,1.19982,1.09482,1.09542,0.980909,0.972507,0.936094,0.8538,0.854319,0.764695,0.754966,0.726533,0.663218,0.663431,0.59421,0.589487,0.567312,0.517628,0.517911,0.463722,0.460025,0.442735,0.403914,0.404135,0.3617,0.358791,0.345353,0.315027,0.315181,0.282095,0.279839,0.269278,0.245644,0.245763,0.219977,0.218188,0.209962,0.191541,0.191625,0.171506,0.170126,0.163703,0.14934,0.149407,0.133711,0.132646,0.127639,0.116437,0.116491,0.104254,0.103429,0.0995162,0.0907799,0.0908252,0.0812948,0.0806391,0.0775971,0.0707876,0.0708216,0.0633857,0.0628832,0.0605093,0.0551997,0.0552255,0.049429,0.0490328,0.0471874,0.0430486,0.0430654,0.0385489,0.0382402,0.0367991,0.0335712,0.0335897,0.0300631,0.0298245,0.0287009,0.0261831,0.0261973,0.0234481,0.0232617,0.0223848,0.0204231,0.0204328,0.0182896,0.0181443,0.0174598,0.0159284,0.0159382,0.014265,0.0141525,0.0136202,0.0124257,0.012433,0.011128,0.0110404,0.0106248,0.00969344,0.00969872,0.00868163,0.00861259,0.0082888,0.00756231,0.00756671,0.0067727,0.00671984,0.00646663,0.0059,0.00590311,0.00528437,0.00524241,0.00504541,0.00460326,0.00460604,0.00412283,0.00409057,0.00393661,0.00359167,0.00359392,0.00321703,0.00319169,0.00307176,0.00280271,0.00280424,0.00251048,0.00249064,0.00239689,0.00218707,0.00218838,0.0019588,0.0019435,0.00187045,0.00170668,0.00170765,0.00152865,0.00151662,0.0014597,0.00133182,0.00133269,0.00119297,0.00118357,0]

sl_pub_marks=[4.004321374,2.012837225,1.849419414,2.222716471,2.209515015,2.181843588,1.907411361,1.852479994,2.222716471,2.167317335,2.278753601,2.222716471,2.222716471,2.550228353,2.539076099,2.318063335,2.600972896,2.640481437,2.564666064,2.620136055,2.603144373,2.571708832,2.58546073,2.620136055,2.59439255,2.559906625,2.591064607,2.612783857,2.613841822,2.5289167,2.597695186,2.580924976,2.568201724,2.247973266,2.463892989,2.322219295,2.252853031,2.198657087,2.240549248,2.428134794,2.245512668,2.342422681,2.167317335,2.240549248,2.28780173,2.484299839,2.301029996,2.255272505,2.442479769,2.463892989,2.278753601,2.397940009,2.356025857,2.322219295,2.350248018,2.301029996,2.336459734,2.309630167,2.397940009,2.283301229,2.315970345,2.419955748,2.320146286,2.245512668,2.23299611,2.380211242,2.389166084,2.290034611,2.478566496,2.322219295,2.408239965,2.421603927,2.469822016,2.281033367,2.278753601,2.471291711,2.326335861,2.285557309,2.367355921,2.36361198,2.283301229,2.40654018,2.414973348,2.465382851,2.294466226,2.283301229,2.419955748,2.367355921,2.369215857,2.419955748,2.334453751,2.403120521,2.267171728,2.374748346,2.416640507,2.294466226,2.404833717,2.369215857,2.382017043,2.392696953,2.198657087,2.320146286,2.315970345,2.382017043,2.292256071,2.301029996,2.434568904,2.365487985,2.46686762,2.350248018,2.401400541,2.278753601,2.357934847,2.456366033,2.359835482,2.484299839,2.305351369,2.250420002,2.387389826,2.36361198,2.307496038,2.403120521,2.281033367,2.357934847,2.423245874,2.303196057,2.374748346,2.447158031,2.305351369,2.36361198,2.399673721,2.29666519,2.397940009,2.281033367,2.372912003,2.376576957,2.269512944,2.283301229,2.227886705,2.367355921,2.397940009,2.303196057,2.471291711,2.318063335,2.292256071,2.392696953,2.357934847,2.346352974,2.330413773,2.276461804,2.350248018,2.440909082,2.346352974,2.482873584,2.336459734,2.419955748,2.418301291,2.451786436,2.309630167,2.281033367,2.444044796,2.342422681,2.414973348,2.416640507,2.463892989,2.292256071,2.298853076,2.414973348,2.389166084,2.403120521,2.374748346,2.298853076,2.414973348,2.274157849,2.238046103,2.26245109,2.309630167,2.383815366,2.292256071,2.31386722,2.40654018,2.305351369,2.264817823,2.209515015,2.281033367,2.428134794,2.342422681,2.227886705,2.29666519,2.40654018,2.309630167,2.274157849,2.45331834,2.40654018,2.403120521,2.36361198,2.459392488,2.354108439,2.496929648,2.334453751,2.414973348,2.419955748,2.440909082,2.307496038,2.238046103,2.322219295,2.423245874,2.311753861,2.383815366,2.383815366,2.305351369,2.387389826,2.303196057,2.324282455,2.414973348,2.352182518,2.217483944,2.206825876,2.372912003,2.390935107,2.307496038,2.209515015,2.385606274,2.404833717,2.269512944,2.225309282,2.445604203,2.397940009,2.409933123,2.36361198,2.33243846,2.357934847,2.283301229,2.326335861,2.439332694,2.365487985,2.482873584,2.346352974,2.397940009,2.440909082,2.442479769,2.311753861,2.230448921,2.485721426,2.324282455,2.290034611,2.36361198,2.359835482,2.326335861,2.385606274,2.285557309,2.346352974,2.394451681,2.068486497]
sl_rates=[19.6541,15.3964,10.2237,7.37309,6.07178,4.58977,3.52024,2.84656,2.43966,2.46138,2.05099,1.71986,1.42912,1.59717,1.74914,1.56872,1.39694,1.61245,1.84908,1.69867,1.62149,1.63751,1.66148,1.59103,1.50942,1.68094,1.62832,1.52683,1.50552,2.05834,1.91383,1.86183,1.7727,2.04354,1.97214,1.94342,1.87866,1.82858,1.76026,1.71015,1.67,1.62685,1.58576,1.54755,1.50918,1.48393,1.51052,1.44431,1.39933,1.40746,1.82726,1.74891,1.73603,1.68594,1.63631,1.57995,1.5565,1.51472,1.46999,1.42848,1.40145,1.3764,1.32771,1.28824,1.23773,1.22324,1.20759,1.16194,1.14826,1.10915,1.09008,1.06404,1.04297,1.01084,0.974824,0.962875,0.945831,0.909971,0.876256,0.871084,0.856886,0.831183,0.813624,0.795604,0.77726,0.750095,0.741021,0.723611,0.699999,0.686305,0.67093,0.658014,0.630859,0.624808,0.616564,0.599394,0.576639,0.571144,0.554224,0.543939,0.524781,0.520046,0.504036,0.498611,0.483038,0.476234,0.466512,0.450884,0.444425,0.434363,0.424345,0.408615,0.40647,0.395202,0.384146,0.380972,0.372395,0.358731,0.350145,0.347934,0.339795,0.33395,0.32074,0.317835,0.313899,0.304827,0.294389,0.292653,0.282891,0.275776,0.271509,0.266626,0.261684,0.25381,0.249643,0.245503,0.239809,0.231739,0.224646,0.222697,0.220426,0.213558,0.2109,0.205262,0.201218,0.196003,0.193478,0.186062,0.184867,0.179754,0.17683,0.174017,0.167516,0.165749,0.16392,0.158607,0.155531,0.153739,0.149011,0.14428,0.143217,0.140507,0.136583,0.134073,0.132236,0.127994,0.122486,0.12342,0.120734,0.117318,0.115899,0.113046,0.111287,0.107819,0.103353,0.103483,0.100801,0.100037,0.0969401,0.0951115,0.0942532,0.0918984,0.0895798,0.0866746,0.0862563,0.0849007,0.082613,0.0802586,0.0792051,0.078326,0.0759073,0.0740297,0.0730375,0.0720223,0.0695823,0.0689034,0.0671352,0.06525,0.064775,0.0631561,0.061724,0.0605782,0.0595103,0.0582734,0.0559108,0.0553491,0.0549907,0.0537576,0.0519946,0.0516555,0.050677,0.049403,0.0479922,0.0470843,0.0466332,0.0451319,0.0441011,0.0425875,0.0426262,0.0422279,0.040757,0.0395711,0.0391827,0.0387336,0.0375517,0.0367061,0.0361056,0.0356314,0.0347277,0.034468,0.0331653,0.0328706,0.0318726,0.03168,0.0309027,0.0299092,0.0296724,0.0291625,0.028524,0.0277966,0.0275002,0.0267292,0.026032,0.0259328,0.025286,0.0246713,0.023963,0.0237244,0.0230794,0.0227022,0.0220042,0.0217849,0.0215536,0.0210376,0]

ef_pub_marks=[16.00432137,2.201397124,2.85308953,2.781036939,2.821513528,2.1430148,3.783903579,2.643452676,2.77524626,2.808210973,2.828015064,2.874481818,5.322219295,3.260071388,2.920645001,2.84509804,4.778874472,4.658964843,4.152288344,3.365487985,8.799340549,4.949877704,3.434568904,3.428134794,4.567026366,3.599883072,2.629409599,5.096910013,4.646403726,4.889301703,4.615950052,3.51054501,2.845718018,4.390935107,7.749736316,4.214843848,3.814247596,3.824776462,6.334453751,4.26245109,4.238046103,4.28780173,4.190331698,4.828659897,4.281033367,3.603144373,4.389166084,3.791690649,5.611723308,3.767155866,5.26245109,4.717670503,4.037426498,4.603144373,3.372912003,3.668385917,6.717670503,4.46686762,4.544068044,3.568201724,4.557507202,4.978180517,4.336459734,5.025305865,4.465382851,4.100370545,3.630427875,4.542825427,4.068185862,5.774516966,5.305351369,5.651278014,4.800029359,4.463892989,4.214843848,3.943494516,3.540329475,4.474216264,3.276461804,6.966141733,4.385606274,5.225309282,4.238046103,5.021189299,3.887054378,4.804139432,4.178976947,4.056904851,6.519827994,6.146128036,6.290034611,3.697229343,4.699837726,4.021189299,5.580924976,4.230448921,4.836324116,4.580924976,3.781036939,4.755112266,4.745074792,4.939519253,4.474216264,4.08278537,4.852479994,3.660865478,4.190331698,4.630427875,4.342422681,5.093421685,5.390935107,5.049218023,4.748188027,3.766412847,4.444044796,4.049218023,3.113943352,5.230448921,4.423245874,3.787460475,4.736396502,5.56937391,4.380211242,5.184691431,4.87909588,4.071882007,3.465382851,4.378397901,4.445604203,4.951823035,3.178976947,4.238046103,3.95568775,3.462397998,4.334453751,1.328071906]
ef_rates=[107.311,111.179,71.3247,40.8699,22.7425,12.3068,8.20585,4.88422,2.75963,1.53078,0.848853,0.460459,0.58671,0.501831,0.277794,0.161757,0.143503,0.465229,0.317967,0.19587,0.447329,7.21236,5.19633,3.95718,2.79684,1.92839,1.32748,1.87172,2.19908,2.02657,1.7878,1.40923,1.07712,0.924842,0.895096,1.57236,1.14032,0.858166,0.74894,0.730975,0.622477,0.698842,1.83701,1.54438,1.22054,0.942903,0.712215,0.537948,0.423734,2.02358,2.20017,2.23999,1.97258,1.67298,1.3604,1.13083,2.17835,5.47367,4.42163,3.4589,2.89574,3.32365,3.42356,3.24567,2.68227,2.33611,1.91064,1.62054,1.294,0.976077,1.07554,1.15777,1.07534,0.893001,0.762798,0.621293,0.51383,0.439988,0.348185,0.288849,0.31621,0.328321,0.29429,0.273798,0.211821,0.174925,0.14476,0.113071,0.0882504,0.113896,0.122768,0.111759,0.0953545,0.0741079,0.0838066,0.0834447,0.0831677,0.0722483,0.0591074,0.059341,0.0781754,0.081525,0.0755593,0.0649555,0.0541859,0.0437969,0.0382868,0.0293967,0.105894,0.08695,0.101569,0.110051,0.101201,0.086247,0.0753729,0.0636757,0.0507993,0.246545,0.209638,0.168115,0.147581,0.175167,0.180585,0.170197,0.159352,0.133257,0.110606,0.0976426,0.0771826,0.0780363,0.0794332,0.0931174,0.0897544,0.0801191,0.0731245,0.0616252,0]

csr2_pub_marks=[4.59439255,0.6954816765,1.017033339,0.6190933306,0.8312296939,0.8937617621,0.6053050461,0.4502491083,1.206825876,0.53529412,0.5526682161,0.9698816437,0.6095944092,0.6803355134,0.9283958523,0.7347998296,0.45484486,1.209515015,1.033423755,0.4216039269,0.8088858674,0.810232518,0.5843312244,0.9283958523,0.6063813651,0.8668778143,0.9754318085,0.6344772702,0.4563660331,1.096910013,0.6454222693,0.4668676204,0.9222062774,0.656098202,0.8000293592,0.9283958523,0.5538830266,1.068185862,1.049218023,0.6739419986,1.089905111,0.9138138524,0.6085260336,0.9666109867,0.5365584426,0.436162647,1.155336037,0.6739419986,0.525044807,1.06069784,0.8149131813,0.5843312244,0.9258275746,0.6963563887,1.178976947,0.719331287,0.5682017241,1.064457989,0.8426092396,0.614897216,0.9986951583,0.6821450764,0.8122446968,0.9143431571,0.6283889301,0.4440447959,1.139879086,0.6739419986,0.5237464668,0.9561684305,0.8808135923,1.127104798,0.6757783417,0.5440680444,1.152288344,0.728353782,0.625312451,1.004321374,0.8426092396,0.6739419986,0.9003671287,0.6627578317,1.161368002,0.6294095991,0.492760389,0.549003262,1.136720567,0.656098202,0.5921767574,0.9324737647,0.9079485216,1.11058971,0.6294095991,0.5502283531,1.173186268,0.7379873263,0.6042260531,0.903089987,0.9694159124,1.120573931,0.6665179806,0.5774917998,1.045322979,0.7032913781,0.4996870826,1.041392685,1.045322979,1.136720567,0.6739419986,0.8808135923,1.049218023,0.6127838567,0.5705429399,1.155336037,0.6766936096,0.4857214265,1.041392685,0.942008053,1.123851641,0.6683859167,0.6283889301,1.184691431,0.7101173651,0.480006943,1.017033339,0.8704039053,1.130333768,0.660865478,0.660865478,1.133538908,0.6776069527,0.4578818967,1.093421685,0.8992731873,0.4857214265,0.8813846568,0.5774917998,0.8175653696,0.9628426812,0.6263403674,0.5538830266,1.139879086,0.7339992865,1.146128036,0.6532125138,0.7626785637,1.056904851,0.6273658566,0.4424797691,1.170261715,0.8603380066,0.4623979979,0.9003671287,0.8536982118,0.5465426635,0.9503648544,0.6180480967,0.5145477527,1.06069784,0.8299466959,0.4440447959,0.940018155,0.791690649,0.5634810854,0.9881128403,0.6211762818,0.6963563887,1.021189299,0.6211762818,0.45331834,1.155336037,0.6757783417,0.5378190951,0.9675479762,0.6170003411,0.665580991,1.045322979,0.6263403674,0.4456042033,1.158362492,0.6739419986,0.5415792439,0.9768083373,0.8603380066,0.5998830721,0.9014583214,0.7168377233,1.176091259,0.7450747916,0.5224442335,1.1430148,0.8208579894,0.5563025008,1.017033339,0.6493348587,0.7930916002,1.053078443,0.6589648427,0.4248816366,1.1430148,0.6693168806,0.5622928645,0.9106244049,0.8864907252,1.127104798,0.6138418219,0.591064607,1.178976947,0.7015679851,0.531478917,1.079181246,0.8808135923,0.6739419986,0.8965262175,0.7497363156,1.152288344,0.7126497016,0.6009728957,1.029383778,0.8325089127,0.6263403674,0.9222062774,0.531478917,0.7427251313,1.008600172,0.5575072019,0.6063813651,1.161368002,0.69019608,0.5954962218,0.9642596302,0.8987251816,1.130333768,0.6503075231,0.6454222693,1.164352856,0.6910814921,0.5705429399,0.9127533037,0.8344207037,0.494154594,0.9025467793,0.5740312677,0.5403294748,1.1430148,0.6042260531,0.5105450102,1.225309282,0.776701184,0.6541765419,0.9314578707,0.5078558717,0.6928469193,0.9618954737,0.6085260336,0.5682017241,1.26245109,0.640481437,0.5987905068,0.9127533037,0.8976270913,1.146128036,0.6294095991,0.6095944092,1.230448921,0.6570558529,0.6273658566,0.949877704,0.8438554226,1.170261715,0.6599162001,0.6085260336,1.195899652,0.652246341,0.42975228,0.952792443,0.9637878273,0.5092025223,0.9324737647,0.5809249757,0.7817553747,0.9951962916,0.6106601631,0.4166405073,1.214843848,0.7923916895,0.4683473304,0.8965262175,0.8426092396,0.5763413502,0.9434945159,0.6138418219,0.4593924878,1.252853031,0.6981005456,0.4885507165,1.086359831,0.8668778143,1.184691431,0.6683859167,0.8808135923,0.9969492485,0.614897216,0.463892989,1.146128036,0.7986506454,1.170261715,0.6683859167,0.7839035793,1.017033339,0.6454222693,0.434568904,1.181843588,0.8234742292,0.4983105538,0.9020028914,0.8500332577,0.5526682161,0.9106244049,0.6242820958,0.4502491083,1.100370545,0.6138418219,0.5390760988,1.004321374,0.8312296939,0.5843312244,0.9858753573,0.6334684556,0.8228216453,0.954724791,0.6589648427,0.4578818967,1.1430148,0.6414741105,0.5301996982,0.9247959958,0.6042260531,0.7626785637,0.9863237771,0.6748611407,0.4563660331,1.133538908,0.638489257,0.531478917,0.959518377,0.8704039053,0.6042260531,0.9190780924,0.6444385895,0.4471580313,1.064457989,0.638489257,0.5340261061,0.9995654882,0.8293037728,0.6095944092,0.9449759084,0.6674529529,0.8432327781,0.9484129658,0.6928469193,0.4216039269,1.123851641,0.638489257,0.551449998,0.9095560292,0.9143431571,1.096910013,0.6354837468,0.5563025008,1.354108439,0.6646419756,0.5587085705,0.9580858485,0.8585371976,0.6374897295,0.903089987,0.5185139399,0.5010592622,1.096910013,0.656098202,0.5658478187,0.9836262871,0.8293037728,0.6503075231,0.9314578707,0.5145477527,0.7041505168,0.9474337219,0.6232492904,0.559906625,1.235528447,0.6848453616,0.5820633629,0.9095560292,0.9289076902,1.10720997,0.6424645202,0.6020599913,1.260071388,0.6683859167,0.6031443726,0.9523080097,0.8494194138,1.130333768,0.631443769,0.614897216,1.209515015,0.6794278966,0.6334684556,1.240549248,0.6618126855,1.103803721,0.6627578317,0.8686444384,0.9749719943,0.5987905068,0.6283889301,1.23299611,0.6627578317,1.113943352,0.6354837468,0.7611758132,1.049218023,0.622214023,0.4313637642,1.214843848,0.767897616,0.5132176001,1.10720997,0.8733206018,1.170261715,0.648360011,0.4377505628,1.152288344,0.6473829701,0.494154594,1.033423755,0.8651039746,0.551449998,1.004321374,0.6364878964,0.7895807122,0.9800033716,0.631443769,0.4265112614,1.195899652,0.6424645202,0.5158738437,0.9537596917,0.9410142437,0.5888317256,0.8920946027,0.5954962218,0.45331834,1.139879086,0.8000293592,0.480006943,0.9278834103,0.8221680794,0.5526682161,0.9881128403,0.6232492904,1.372912003,0.6937269489,0.5237464668,1.06069784,0.8195439355,0.5888317256,1.004321374,0.6211762818,0.8068580295,0.9777236053,0.6665179806,0.4756711883,1.127104798,0.6294095991,0.525044807,0.9872192299,0.8674674879,0.6170003411,0.8744818177,0.6444385895,0.4683473304,1.103803721,0.620136055,0.5145477527,1.029383778,0.8149131813,0.5954962218,0.9329808219,0.6589648427,0.8767949762,0.9395192526,0.688419822,0.4578818967,1.11058971,0.625312451,0.5198279938,0.9390197764,0.6394864893,0.7803173121,0.9410142437,0.4899584794,0.5145477527,1.225309282,0.6434526765,0.532754379,0.9731278536,0.8959747324,1.100370545,0.6532125138,0.5526682161,1.28780173,0.6665179806,0.5587085705,0.9951962916,0.8305886687,0.6414741105,0.9237619608,0.4871383755,0.7803173121,0.9503648544,0.5943925504,0.5415792439,1.269512944,0.665580991,0.5682017241,0.9041743683,0.5065050324,0.7259116323,0.9304395948,0.5705429399,0.5646660643,1.283301229,0.6693168806,0.5774917998,0.9222062774,0.882524538,1.1430148,0.6551384348,0.5899496013,1.238046103,0.6503075231,0.6138418219,0.9580858485,0.8356905715,0.4857214265,1.071882007,0.5185139399,0.7520484478,0.9415114326,0.583198774,0.5976951859,1.23299611,0.6580113967,1.130333768,0.6344772702,0.8228216453,1.025305865,0.6063813651,0.6170003411,1.227886705,0.651278014,0.6344772702,0.9258275746,0.8692317197,1.152288344,0.6374897295,0.6324572922,1.176091259,0.6702458531,0.4471580313,1.100370545,0.8721562727,0.4771212547,0.8796692056,0.5774917998,0.8325089127,0.9633155114,0.611723308,0.42975228,1.198657087,0.7937903847,0.4623979979,0.9164539485,0.591064607,0.7250945211,0.9628426812,0.625312451,0.4727564493,1.161368002,0.7888751158,0.5092025223,0.9090208542,0.8155777483,0.5611013836,0.9532763367,0.6159500517,0.4232458739,1.100370545,0.625312451,0.5378190951,1,0.845718018,0.583198774,0.9872192299,0.622214023,0.8506462352,0.9532763367,0.6434526765,0.4593924878,1.146128036,0.6211762818,0.5263392774,0.9561684305,0.6138418219,0.7535830589,0.9731278536,0.6618126855,0.4608978428,1.149219113,0.6374897295,0.531478917,0.9698816437,0.8494194138,0.5899496013,0.9247959958,0.6464037262,0.4517864355,1.075546961,0.640481437,0.5198279938,1.012837225,0.8344207037,0.6031443726,0.9503648544,0.6599162001,0.8280150642,0.9474337219,0.6857417386,0.45331834,1.123851641,0.6344772702,0.5185139399,0.937517892,0.9090208542,1.11058971,0.6394864893,0.5611013836,1.318063335,0.6776069527,0.5477747054,0.9777236053,0.8530895299,0.6242820958,0.9116901588,0.6794278966,1.336459734,0.6963563887,0.593286067,1.017033339,0.8312296939,0.640481437,0.9429995934,0.6972293428,1.281033367,0.6919651028,0.6074550232,1.309630167,0.665580991,0.5843312244,0.9444826722,0.903089987,1.113943352,0.6711728427,0.57863921,1.26245109,0.6830470382,0.5774917998,0.9503648544,0.845718018,1.155336037,0.6464037262,0.5954962218,1.206825876,0.6702458531,0.620136055,1.252853031,0.6674529529,1.103803721,0.6532125138,0.8709888138,0.9872192299,0.630427875,0.5899496013,1.220108088,0.6570558529,0.625312451,0.9350031515,0.8898617213,1.10720997,0.6334684556,0.6364878964,1.212187604,0.6757783417,0.6374897295,0.9329808219,0.8500332577,1.1430148,0.6424645202,0.4216039269,0.6954816765,0.8785217955,0.593286067,0.5976951859,1.190331698,0.6665179806,1.10720997,0.6532125138,0.7979596437,0.9894498177,0.6434526765,0.428134794,0.9585638832,0.7411515989,0.5378190951,1.012837225,0.6211762818,0.7387805585,1.037426498,0.6374897295,0.42975228,1.167317335,0.6434526765,0.5211380837,0.9804578923,0.8893017025,0.587710965,0.9513375188,0.5976951859,0.9074113608,0.9666109867,0.625312451,0.436162647,1.158362492,0.6283889301,0.5132176001,0.9633155114,0.6074550232,0.7543483357,0.9599948383,0.6637009254,0.4742162641,0.3175809986]
csr2_rates=[13.5594,6.90512,5.99692,5.8137,5.09434,5.95789,5.34934,3.67495,3.2995,3.8706,3.30248,2.43117,2.28817,2.29584,2.06095,1.91752,1.27463,1.12379,2.04952,3.1273,3.4864,4.13426,3.56716,3.46123,3.06282,2.06689,3.04671,2.71184,1.72308,1.73142,2.20593,1.78198,1.63915,1.56679,1.39145,1.58666,1.34627,1.89903,16.3813,15.6257,12.7509,13.7162,13.0134,15.717,12.4473,9.87757,11.1345,14.3191,11.3506,9.79147,13.3702,11.9177,13.2773,11.4823,9.28924,16.5786,12.7637,9.03145,14.6417,12.392,12.436,11.3532,10.9723,14.7977,11.3214,8.62349,9.80876,12.5164,9.73204,10.452,11.009,10.2219,12.2283,9.10146,8.4459,12.2335,9.38313,8.31207,11.0874,8.93037,10.7191,7.8133,7.73384,9.86929,8.8665,6.78192,7.98961,9.6894,7.43193,8.83284,7.38651,8.4682,9.52671,6.13669,5.92574,8.72233,5.77617,6.36721,7.74114,7.04986,8.29533,5.02875,5.3149,7.30335,6.24644,4.94238,7.26865,6.53135,7.8307,5.91694,7.4358,7.97674,5.68753,6.06159,7.74001,5.41762,6.734,6.14793,6.32756,7.26538,5.07838,4.76511,6.58624,4.45876,5.54818,6.38619,5.56206,6.45588,4.39565,5.48659,6.54461,4.40216,4.44267,6.2372,4.60809,5.3223,5.15134,4.04721,5.70439,5.68451,3.45248,4.57049,5.63574,4.04099,4.71003,4.58986,5.1557,5.16761,3.44549,3.33737,4.8905,3.48225,3.74964,4.42722,3.9998,4.54465,4.24094,2.70776,3.84245,4.60981,3.04974,3.13177,4.22919,3.71862,3.74672,3.68441,2.79672,4.25702,3.65631,2.8856,2.95485,3.92891,3.16185,3.17846,3.05452,2.83111,3.77242,3.22079,2.48892,2.58889,3.43156,2.75676,2.56036,3.16812,2.86141,3.39147,2.90824,2.21462,3.58086,2.4677,2.02133,3.17923,2.35153,2.62536,2.27651,2.02447,3.0771,2.37589,1.78314,2.19691,2.71355,2.08113,2.35735,2.27623,2.2971,2.75895,2.10773,1.69458,2.54017,1.7457,1.77662,2.28295,1.90969,2.39758,1.87221,1.80481,2.48728,1.56762,1.49606,2.26333,1.52731,1.75567,1.69858,1.54669,2.03442,2.06698,1.54357,1.47493,1.98822,1.27094,1.61396,1.61656,1.68031,1.90911,1.30614,1.34333,1.79622,1.09431,1.17426,1.47525,1.34644,1.50861,1.48693,0.953248,1.38173,1.47623,1.22961,1.15943,2.48797,1.83158,2.2027,1.75575,1.73804,2.16943,2.26202,1.5789,1.67643,2.15983,1.55789,1.80329,1.89032,1.82729,2.07424,1.39046,1.63645,2.00977,1.3716,1.5063,1.95813,1.50781,1.7851,1.21801,1.63337,1.88077,1.25096,1.13327,1.69166,1.35925,1.45094,1.44735,1.32069,1.6333,1.64161,1.05056,1.05195,1.60649,1.132,1.21695,1.32187,1.27737,1.43411,1.39465,0.895187,1.2369,1.47073,0.952248,1.01377,1.34087,1.07787,1.24849,0.863705,1.32036,1.26706,0.826052,0.941583,1.26166,0.913933,1.03277,0.971367,1.23376,1.17894,0.757506,0.8252,1.11949,0.767837,0.861918,0.991139,0.899868,1.10151,0.979157,0.625023,0.854042,1.03357,0.834463,0.705372,0.968108,0.846913,0.902283,0.855825,0.678687,1.03122,0.903886,0.58174,0.695629,0.886185,0.726839,0.781898,0.704117,0.705961,0.926836,0.797582,0.510029,0.637098,0.798915,0.635003,0.618017,0.714734,0.645169,0.815871,0.674301,0.444327,0.646144,0.745568,0.582694,0.516917,0.729546,0.596944,0.675613,0.584009,0.489033,0.761566,0.613986,0.400729,0.518227,0.637404,0.500188,0.580683,0.517855,0.565733,0.659415,0.480273,0.383582,0.561027,0.440108,0.468139,0.547966,0.445796,0.582558,0.464028,0.354592,0.481609,0.556036,0.405731,0.386649,0.539265,0.413158,0.505128,0.399061,0.365134,0.482891,0.502861,0.35978,0.364566,0.48248,0.349089,0.414415,0.368906,0.41552,0.46411,0.316302,0.321163,0.424431,0.303111,0.349739,0.418974,0.347758,0.405273,0.285173,0.34415,0.412818,0.282057,0.308022,0.380014,0.305253,0.342102,0.258386,0.35879,0.364744,0.238325,0.282479,0.349258,0.252714,0.292204,0.294421,0.30975,0.323596,0.214875,0.216867,0.320861,0.21892,0.229084,0.2959,0.246811,0.283571,0.189298,0.21832,0.289008,0.244192,0.183244,0.268252,0.247443,0.22601,0.230546,0.197986,0.274971,0.265842,0.171837,0.178656,0.243264,0.204419,0.194103,0.202002,0.196415,0.247865,0.218903,0.144923,0.175723,0.223892,0.157913,0.167225,0.205767,0.182713,0.202778,0.193241,0.140373,0.216274,0.176909,0.131056,0.203955,0.18108,0.172791,0.165142,0.146617,0.204564,0.182795,0.115091,0.141719,0.179634,0.144266,0.138537,0.154142,0.140055,0.184858,0.156024,0.100893,0.132961,0.160655,0.129189,0.116509,0.1562,0.131922,0.152862,0.134109,0.0998826,0.165617,0.137504,0.0886355,0.112758,0.140175,0.111188,0.129529,0.111401,0.1071,0.152524,0.121421,0.0916793,0.0976288,0.129094,0.0999612,0.104875,0.109551,0.106603,0.128231,0.0966315,0.0899379,0.121425,0.0914769,0.0879154,0.116971,0.0938745,0.114833,0.0916122,0.0724785,0.106163,0.112306,0.0818313,0.079613,0.107441,0.0797288,0.095212,0.0758991,0.0785852,0.100174,0.101337,0.0712838,0.0688474,0.0933603,0.0687797,0.0790322,0.0866683,0.0777715,0.092031,0.064215,0.0713485,0.09037,0.0644026,0.0654269,0.0851047,0.0638882,0.0777576,0.0663995,0.0550596,0.079663,0.0801976,0.0551466,0.0602895,0.0777188,0.0571774,0.0663752,0.0595231,0.0693045,0.0720792,0.0485534,0.056487,0.0689371,0.0452144,0.056488,0.0639655,0.055914,0.0638961,0.0421513,0.0557634,0.0651623,0.0439035,0.0451032,0.0611201,0.0455039,0.0539317,0.0515708,0.0394153,0.0592381,0.0577637,0.037161,0.0387825,0.056002,0.0395016,0.0449515,0.0432029,0.0449724,0.0536233,0.0503374,0.0333026,0.0367656,0.0495107,0.0346623,0.0380808,0.0440049,0.0403015,0.0466485,0.0443446,0.027921,0.0366044,0.0460877,0.0376744,0.0304987,0.0419882,0.0387433,0.0390179,0.0372703,0.0297816,0.0451017,0.0405753,0.0256812,0.0307233,0.0392195,0.0320428,0.0320615,0.0314107,0.032512,0.0404818,0.0357661,0.0233942,0.0271266,0.0342982,0.0284823,0.0270707,0.0320584,0.0284686,0.0346796,0.0304193,0.0197258,0.0280837,0.0339898,0.0267075,0.0212335,0.0313471,0.0271653,0.0295045,0.0260535,0.0222637,0.0334756,0.0273864,0.0178523,0.0225858,0.0281956,0.0221601,0.0243364,0.023243,0.0240263,0.0290081,0.0219175,0.0178221,0.0251912,0.0198355,0.0201149,0.0242347,0.0203932,0.0260464,0.020595,0.0176383,0.0256087,0.019302,0.0161665,0.0238464,0.0186548,0.0213962,0.0177511,0.0180506,0.0237563,0.016766,0.0149278,0.0208656,0.015613,0.0181873,0.016959,0.0173243,0.0201443,0.0145312,0.0142191,0.0189231,0.013877,0.0149992,0.0180788,0.0153456,0.0182271,0.0126974,0.0147908,0.0182708,0.0126441,0.0129466,0.017264,0.0131525,0.0148501,0.0117818,0.0154748,0.0158102,0.0108198,0.0122412,0.0152461,0.0103913,0.0131012,0.0132523,0.012856,0.0144817,0.00961335,0.0112277,0.0140114,0.0094514,0.0108937,0.0132725,0.0109219,0.0124852,0.00828438,0.00804883,0.0133719,0.0125211,0.00794136,0.0100334,0.0120388,0.00951422,0.0104935,0.00912616,0.0116275,0.0113641,0.00755468,0.00676461,0.0111914,0.00981114,0.00827137,0.00886833,0.00957399,0.010007,0.0103199,0.00678096,0.0073478,0.00985547,0.00827622,0.00702761,0.00915615,0.00830689,0.00893234,0.0084348,0.00570955,0.00952567,0.00886052,0.00562005,0.00654474,0.0085247,0.00699918,0.0072404,0.00711719,0.00682107,0.00894673,0.00804454,0.00516798,0.00611384,0]

fi_pub_marks=[3.201397124,2.462397998,1.049218023,16.80345712,5.173186268,6.509202522,15.8488047,6.951337519,5.155336037,6.033423755,8.28780173,26.13033377,8.797959644,10.79934055,10.20411998,19.94101424,10.79098848,32.58546073,11.24551267,12.08278537,10.67024585,10.57170883,10.41497335,10.78532984,10.71180723,12.57634135,9.991226076,10.87621784,10.04532298,11.93550727,9.611723308,10.35793485,11,10.41329976,13.54654266,9.322219295,9.582063363,10.87157294,10.30749604,11.17897695,10.52244423,10.89872518,10.41497335,11.66370093,10.83058867,11.14921911,10.40823997,11.13353891,11.04532298,10.41497335,10.28330123,10.96236934,10.38021124,11.13672057,10.83569057,3.096392391]
fi_rates=[28.6073,8.12846,2.24579,4.55708,4.78378,2.88844,3.9962,1.9933,0.999279,0.713054,0.377453,0.587137,1.30514,0.931115*1.2,0.700363*1.2,0.768382*1.2,0.887576*1.2,0.883418*1.2,2.49142*1.3,2.13369*1.3,1.76971*1.3,1.32509*1.3,0.989725*1.3,0.742359,0.553935,0.467195,0.440613,0.411049,0.370603,0.358676,0.32962,0.25625,0.194581,0.147909,0.120827,0.137632,0.110028,0.0866539,0.066838,0.0515617,0.0392298,0.0305642,0.0255982,0.0445666,0.0424545,0.0410563,0.0396292,0.0386451,0.03711,0.0357265,0.0345469,0.0338498,0.0325913,0.0316408,0.0305205,0.0294317,0]

fp_pub_marks = [3.611723308,0.5797835966,1.50242712,0.6053050461,8.73479983,0.9717395909,1.247973266,1.868644438,0.7291647897,1.33243846,0.8344207037,2.079181246,1.851869601,12.08278537,5.155336037,4.222716471,3.799340549,3.825426118,5.451786436,4.40654018,7.755874856,9.403120521,4.40654018,3.688419822,5.149219113,3.913283902,4.053078443,5.857935265,3.677606953,7.133538908,2.206825876,8.385606274,3.655138435,4.530199698,5.828015064,8.227886705,2.986771734,4.324282455,9.995635195,3.907411361,3.5774918,5.828659897,2.915399835,4.531478917,3.559906625,9.588831726,3.936010796,4.44870632,2.100370545,6.161368002,1.930949031,3.544068044,5.198657087,3.883661435,4.781755375,2.992111488,2.139879086,4.004321374,3.568201724,4.836324116,4.542825427,8.103803721,5.50242712,2.589949601,5.828015064,4.071882007,4.991669007,3.818225894,4.274157849,3.88592634,7.770115295,8.416640507,4.791690649,5.133538908,9.021189299,7.926856709,12.08278537,6.252853031,3.357934847,5.113943352,3.949877704,4.654176542,4.086359831,5.706717782,3.682145076,5.178976947,4.437750563,3.979092901,4.209515015,5.503790683,3.440909082,7.890979597,5.505149978,4.480006943,5.481442629,8.392696953,3.556302501,5.419955748,4.389166084,7.354108439,8.44870632,9.113943352,5.767155866,2.592176757,3.307496038,5.739572344,3.33243846,5.431363764,7.683047038,4.369215857,5.155336037,3.586587305,5.790285164,3.274157849,5.503790683,4.096910013,6.903632516,2.534026106,4.595496222,8.093421685,8.741151599,3.88536122,5.771230665]
fp_rates=[10.8185,9.16974,3.08324,1.11374,4.79887,5.60972,2.50497,1.31903,0.446753,0.272924,0.104652,0.0947561,0.0606064,0.25275,4.36802,4.76713,4.20369,3.58254,3.75855,4.27775,5.66563,10.1793,13.5907,11.6203,9.28978,8.14163,6.24079,5.31633,5.82501,6.2094,5.66382,4.92193,8.02195,7.89514,7.76069,10.1218,10.3776,6.11956,5.49694,16.0335,11.9699,7.79807,7.16525,4.16829,3.19882,3.01016,3.09866,2.12602,12.9078,10.5713,6.04869,5.15861,4.19599,3.34896,3.17874,2.35558,1.27511,1.30796,0.96147,0.987025,0.879559,1.30079,1.55056,1.21435,0.890163,0.734695,0.623128,0.517474,0.350732,0.32347,0.215649,0.252901,0.23356,0.257469,0.196112,0.248543,0.33579,0.829641,0.590397,0.640895,0.336006,0.310297,0.176099,0.156247,0.129039,0.101941,0.0741186,0.0717321,0.0555274,0.0520057,0.0458632,0.0515752,0.0668207,0.0485988,0.0440824,0.0557111,0.0847342,0.098812,0.0910706,0.104753,0.153222,0.377214,0.572195,0.424052,0.307986,0.365425,0.204343,0.247779,0.182765,0.160513,0.159601,0.147573,0.18316,0.130759,0.142792,0.125021,0.164287,0.121452,0.142488,0.148065,0.215199,0.249187,0.192534,0]

# dummy cts for testing or to be replaced with new offical cts
fi2_pub_marks=[3.201397124,2.462397998,1.049218023,16.80345712,5.173186268,6.509202522,15.8488047,6.951337519,5.155336037,6.033423755,8.28780173,26.13033377,8.797959644,10.79934055,10.20411998,19.94101424,10.79098848,32.58546073,11.24551267,12.08278537,10.67024585,10.57170883,10.41497335,10.78532984,10.71180723,12.57634135,9.991226076,10.87621784,10.04532298,11.93550727,9.611723308,10.35793485,11,10.41329976,13.54654266,9.322219295,9.582063363,10.87157294,10.30749604,11.17897695,10.52244423,10.89872518,10.41497335,11.66370093,10.83058867,11.14921911,10.40823997,11.13353891,11.04532298,10.41497335,10.28330123,10.96236934,10.38021124,11.13672057,10.83569057,3.096392391]
fi2_rates=[28.6073,8.12846,2.24579,4.55708,4.78378,2.88844,3.9962,1.9933,0.999279,0.713054,0.377453,0.587137,1.30514,0.931115,0.700363,0.768382,0.887576,0.883418,2.49142,2.13369,1.76971,1.32509,0.989725,0.742359,0.553935,0.467195,0.440613,0.411049,0.370603,0.358676,0.32962,0.25625,0.194581,0.147909,0.120827,0.137632,0.110028,0.0866539,0.066838,0.0515617,0.0392298,0.0305642,0.0255982,0.0445666,0.0424545,0.0410563,0.0396292,0.0386451,0.03711,0.0357265,0.0345469,0.0338498,0.0325913,0.0316408,0.0305205,0.0294317,0]

fp2_pub_marks = [3.611723308,0.5797835966,1.50242712,0.6053050461,8.73479983,0.9717395909,1.247973266,1.868644438,0.7291647897,1.33243846,0.8344207037,2.079181246,1.851869601,12.08278537,5.155336037,4.222716471,3.799340549,3.825426118,5.451786436,4.40654018,7.755874856,9.403120521,4.40654018,3.688419822,5.149219113,3.913283902,4.053078443,5.857935265,3.677606953,7.133538908,2.206825876,8.385606274,3.655138435,4.530199698,5.828015064,8.227886705,2.986771734,4.324282455,9.995635195,3.907411361,3.5774918,5.828659897,2.915399835,4.531478917,3.559906625,9.588831726,3.936010796,4.44870632,2.100370545,6.161368002,1.930949031,3.544068044,5.198657087,3.883661435,4.781755375,2.992111488,2.139879086,4.004321374,3.568201724,4.836324116,4.542825427,8.103803721,5.50242712,2.589949601,5.828015064,4.071882007,4.991669007,3.818225894,4.274157849,3.88592634,7.770115295,8.416640507,4.791690649,5.133538908,9.021189299,7.926856709,12.08278537,6.252853031,3.357934847,5.113943352,3.949877704,4.654176542,4.086359831,5.706717782,3.682145076,5.178976947,4.437750563,3.979092901,4.209515015,5.503790683,3.440909082,7.890979597,5.505149978,4.480006943,5.481442629,8.392696953,3.556302501,5.419955748,4.389166084,7.354108439,8.44870632,9.113943352,5.767155866,2.592176757,3.307496038,5.739572344,3.33243846,5.431363764,7.683047038,4.369215857,5.155336037,3.586587305,5.790285164,3.274157849,5.503790683,4.096910013,6.903632516,2.534026106,4.595496222,8.093421685,8.741151599,3.88536122,5.771230665]
fp2_rates=[10.8185,9.16974,3.08324,1.11374,4.79887,5.60972,2.50497,1.31903,0.446753,0.272924,0.104652,0.0947561,0.0606064,0.25275,4.36802,4.76713,4.20369,3.58254,3.75855,4.27775,5.66563,10.1793,13.5907,11.6203,9.28978,8.14163,6.24079,5.31633,5.82501,6.2094,5.66382,4.92193,8.02195,7.89514,7.76069,10.1218,10.3776,6.11956,5.49694,16.0335,11.9699,7.79807,7.16525,4.16829,3.19882,3.01016,3.09866,2.12602,12.9078,10.5713,6.04869,5.15861,4.19599,3.34896,3.17874,2.35558,1.27511,1.30796,0.96147,0.987025,0.879559,1.30079,1.55056,1.21435,0.890163,0.734695,0.623128,0.517474,0.350732,0.32347,0.215649,0.252901,0.23356,0.257469,0.196112,0.248543,0.33579,0.829641,0.590397,0.640895,0.336006,0.310297,0.176099,0.156247,0.129039,0.101941,0.0741186,0.0717321,0.0555274,0.0520057,0.0458632,0.0515752,0.0668207,0.0485988,0.0440824,0.0557111,0.0847342,0.098812,0.0910706,0.104753,0.153222,0.377214,0.572195,0.424052,0.307986,0.365425,0.204343,0.247779,0.182765,0.160513,0.159601,0.147573,0.18316,0.130759,0.142792,0.125021,0.164287,0.121452,0.142488,0.148065,0.215199,0.249187,0.192534,0]


all_cts_pub_marks = [wsp_pub_marks, sl_pub_marks, ef_pub_marks, csr2_pub_marks, fi_pub_marks, fp_pub_marks, fi2_pub_marks, fp2_pub_marks]
all_cts_rates = [wsp_rates, sl_rates, ef_rates, csr2_rates, fi_rates, fp_rates, fi2_rates, fp2_rates]


def initialize_ct_pub_count(distribution, ct_pub_count_array, all_cts_pub_marks):
    for i in range(0, 7):
        if (distribution[i] >= 600):
            ct_pub_count_array[i] = len(all_cts_pub_marks[i])
        else:
            adjust = initialize_ct_pub_count_helper(distribution[i], all_cts_pub_marks[i], ct_pub_count_array,i)
            if adjust != 0:
                all_cts_pub_marks[i][ct_pub_count_array[i]] = adjust

def initialize_ct_pub_count_helper(ct, ct_pub_marks, ct_pub_count_array,index):
    for i in range(0, len(ct_pub_marks)):
        if ct > 0:
            ct -= ct_pub_marks[i]
            ct_pub_count_array[index] += 1
        if ct < 0:
            ct_pub_count_array[index] -= 1
            return ct*-1
        if ct == 0:
            ct_pub_count_array[index] = 0
            return 0
            
def calculate_ct_to_push(all_cts_rates, ct_pub_count_array,elapsed_time):
    rates = [all_cts_rates[0][ct_pub_count_array[0]],
             all_cts_rates[1][ct_pub_count_array[1]],
             all_cts_rates[2][ct_pub_count_array[2]],
             all_cts_rates[3][ct_pub_count_array[3]],
             all_cts_rates[4][ct_pub_count_array[4]],
             all_cts_rates[5][ct_pub_count_array[5]],
             all_cts_rates[6][ct_pub_count_array[6]],
             all_cts_rates[7][ct_pub_count_array[7]]]
    
   
    taus_to_gain = all_cts_pub_marks[0][ct_pub_count_array[0]:len(all_cts_pub_marks[0])]
    temp = all_cts_rates[0][ct_pub_count_array[0]:len(all_cts_rates[0])]
    if len(temp) > 0:
        max_rates = temp[0]
        for i in range(1, len(taus_to_gain)):
            total_time = 0
            for j in range (0, i):
                total_time += taus_to_gain[j]/temp[j]
            sum_splice = taus_to_gain[0:i]
            if (sum(sum_splice) / total_time) > max_rates:
                max_rates = sum(sum_splice) / total_time

        rates[0] = max_rates
  

    
    taus_to_gain = all_cts_pub_marks[1][ct_pub_count_array[1]:len(all_cts_pub_marks[1])]
    temp = all_cts_rates[1][ct_pub_count_array[1]:len(all_cts_rates[1])]
    total_time = 0
    
    if len(temp) > 0:
        max_rates = temp[0]
        for i in range(1, len(taus_to_gain)):
            total_time = 0
            for j in range (0, i):
                total_time += taus_to_gain[j]/temp[j]
            sum_splice = taus_to_gain[0:i]
            if (sum(sum_splice) / total_time) > max_rates:
                max_rates = sum(sum_splice) / total_time

        rates[1] = max_rates
  

    
    taus_to_gain = all_cts_pub_marks[2][ct_pub_count_array[2]:len(all_cts_pub_marks[2])]
    temp = all_cts_rates[2][ct_pub_count_array[2]:len(all_cts_rates[2])]
    
    if len(temp) > 0:
        max_rates = temp[0]
        for i in range(1, len(taus_to_gain)):
            total_time = 0
            for j in range (0, i):
                total_time += taus_to_gain[j]/temp[j]
            sum_splice = taus_to_gain[0:i]
            if (sum(sum_splice) / total_time) > max_rates:
                max_rates = sum(sum_splice) / total_time

        rates[2] = max_rates

    
    taus_to_gain = all_cts_pub_marks[3][ct_pub_count_array[3]:len(all_cts_pub_marks[3])]
    temp = all_cts_rates[3][ct_pub_count_array[3]:len(all_cts_rates[3])]
    if len(temp) > 0:
        max_rates = temp[0]
        for i in range(1, len(taus_to_gain)):
            total_time = 0
            for j in range (0, i):
                total_time += taus_to_gain[j]/temp[j]
            sum_splice = taus_to_gain[0:i]
            if (sum(sum_splice) / total_time) > max_rates:
                max_rates = sum(sum_splice) / total_time

        rates[3] = max_rates

 

    
    taus_to_gain = all_cts_pub_marks[4][ct_pub_count_array[4]:len(all_cts_pub_marks[4])]
    temp = all_cts_rates[4][ct_pub_count_array[4]:len(all_cts_rates[4])]
    
    if len(temp) > 0:
        max_rates = temp[0]
        for i in range(1, len(taus_to_gain)):
            total_time = 0
            for j in range (0, i):
                total_time += taus_to_gain[j]/temp[j]
            sum_splice = taus_to_gain[0:i]
            if (sum(sum_splice) / total_time) > max_rates:
                max_rates = sum(sum_splice) / total_time

        rates[4] = max_rates
  
    
    
    taus_to_gain = all_cts_pub_marks[5][ct_pub_count_array[5]:len(all_cts_pub_marks[5])]
    temp = all_cts_rates[5][ct_pub_count_array[5]:len(all_cts_rates[5])]
    if len(temp) > 0:
        max_rates = temp[0]
        for i in range(1, len(taus_to_gain)):
            total_time = 0
            for j in range (0, i):
                total_time += taus_to_gain[j]/temp[j]
            sum_splice = taus_to_gain[0:i]
            if (sum(sum_splice) / total_time) > max_rates:
                max_rates = sum(sum_splice) / total_time
        

        rates[5] = max_rates 

    
    if (ct_pub_count_array[6] < 22): #fi
        temp = all_cts_rates[6][ct_pub_count_array[6]:22]
        rates[6] = sum(temp) / len(temp)
    if (ct_pub_count_array[6] >41 and ct_pub_count_array[6] < 46):
        rates[6] = (all_cts_rates[6][ct_pub_count_array[6]])*3

    if (ct_pub_count_array[7] < 64): #fp
        temp = all_cts_rates[7][ct_pub_count_array[7]:64]
        rates[7] = sum(temp) / len(temp)
    if ( ct_pub_count_array[7] > 83 and ct_pub_count_array[7] < 101):
        rates[7] = (all_cts_rates[7][ct_pub_count_array[7]])*3

    """if elapsed_time < 168:
        rates[1] = 0
        rates[2] = 0
        rates[3] = 0
        rates[4] = 0
        rates[5] = 0
    
    if elapsed_time > 168 and elapsed_time < 2592:
        rates[2] = 0
        rates[3] = 0
        rates[4] = 0
        rates[5] = 0
    
    if elapsed_time > 2592 and elapsed_time < 19368:
        rates[4] = 0
        rates[5] = 0"""


    # disables dummy cts unless you want to add them
    if elapsed_time > -1: # change this to :elapsed_time < time in hours to test new cts drops at a specific time in future
        #rates[0] = 0
        #rates[1] = 0
        #rates[2] = 0
        #rates[3] = 0
        #rates[4] = 0
        #rates[5] = 0
        rates[6] = 0
        rates[7] = 0
    
    return rates.index(max(rates))

def generate_ct_routing(distribution, ct_pub_count_array, all_cts_pub_marks, all_cts_rates, ct_tau_array, ct_time_array):
    initialize_ct_pub_count(distribution, ct_pub_count_array, all_cts_pub_marks)
    elapsed_time = 0
    cts = distribution[0:7]

    # Open text file for writing (outside of the loop)
   
    with open(r"", 'w') as routing_file, \
         open(r"", "w") as lookup_file: # set absolute path of ct_routing.txt and ct_tau_lookup_table.txt

        while sum(cts) < 3599:  # Change to 4799 to test 8 cts
        #while elapsed_time < 3000:
            # Write cts to the file
            routing_file.write(' '.join([f"{round(cts[i], 1)}" for i in range(6)]) + ' ' + str(round(elapsed_time/24,3)) + "\n")



            fastest = calculate_ct_to_push(all_cts_rates, ct_pub_count_array, elapsed_time)
            elapsed_time = generate_ct_routing_helper(fastest, cts, ct_pub_count_array, all_cts_pub_marks, all_cts_rates, elapsed_time)

            # Cap cts to 600 in case it goes over
            for i in range(6):
                if cts[i] > 600:
                    cts[i] = 600

            ct_tau_array.append(round(sum(cts), 3))
            ct_time_array.append(round(elapsed_time / 24, 3))

        # Generate the ct lookup table after the loop
        for i in range(len(ct_time_array) - 1):
            steps = round((ct_time_array[i + 1] - ct_time_array[i]) / 0.001)
            step_length = (ct_tau_array[i + 1] - ct_tau_array[i]) / (steps + 0.0000000000001)

            for j in range(steps):
                time_value = round(ct_time_array[i] + j * 0.001, 3)
                tau_value = round(ct_tau_array[i] + j * step_length, 3)
                lookup_file.write(f"{time_value} {tau_value}\n")


def generate_ct_routing_helper(fastest,cts,ct_pub_count_array,all_cts_pub_marks,all_cts_rates,elapsed_time):
        #print(ct_pub_count_array)
        cts[fastest] += all_cts_pub_marks[fastest][ct_pub_count_array[fastest]]
        elapsed_time += all_cts_pub_marks[fastest][ct_pub_count_array[fastest]]/all_cts_rates[fastest][ct_pub_count_array[fastest]]
        ct_pub_count_array[fastest] += 1
        return elapsed_time



generate_ct_routing(distribution,ct_pub_count_array,all_cts_pub_marks,all_cts_rates,ct_tau_array,ct_time_array)



